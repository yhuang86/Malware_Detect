import pandas as pd

def createVocabList(dataSet):
    vocabSet = set([])  #create empty set
    for document in dataSet:
        for i in document:
            i = i.upper()
        vocabSet = vocabSet | set(document) #union of the two sets
    return list(vocabSet)

def textParse(bigString):    #input is big string, #output is word list5
    import re
    listOfTokens = re.split(r'\W+', bigString)
    #print(listOfTokens)
    #return [tok.lower() for tok in listOfTokens if len(tok) > 2]
    return [tok for tok in listOfTokens if len(tok) > 2]
    

if __name__ == "__main__":
    docList=[]; classList = []; fullText =[]
    for i in range(1,501):
        wordList = textParse(open('training_data/badSRC/%d.txt' % i).read()) #import baddata
        docList.append(wordList)
        fullText.extend(wordList)
        classList.append(1)
        wordList = textParse(open('training_data/goodSRC/%d.txt' % i).read()) #import gooddata
        docList.append(wordList)
        fullText.extend(wordList)
        classList.append(0)

    for i in range(1,251):
        wordList = textParse(open('testing_data/BadDone/%d.txt' % i).read())
        docList.append(wordList)
        fullText.extend(wordList)
        classList.append(1)

        wordList = textParse(open('testing_data/GoodDone/%d.txt' % i).read())
        docList.append(wordList)
        fullText.extend(wordList)
        classList.append(0)

    vocabList = createVocabList(docList)#create vocabulary
    #print (vocabList)

    result = pd.DataFrame(index = range(1500), columns=list(vocabList))
    for col in result.columns:
        result[col].values[:] = 0
    #print(result)
    #for i in range(0,1500): #add data
    #result.loc[0,"PROCESS_OUTGOING_CALLS"] = 1
    for i in range(0,1500):
        for j in docList[i]:
            result.loc[i,j] = 1
            #print(j)

    print(result)


    for i in range(0,1500):
        result.loc[i,"Result"] = classList[i]

    print(result)

    result.to_csv("data.csv")
